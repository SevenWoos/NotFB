<!-- view_profile.html -->
{% extends 'base.html' %}

{% block content %}
<div class="profile-container">

    <!-- Cover Photo -->
    <div class="cover-photo">
        <img src="{{ url_for('static', filename='cover.jpg') }}" alt="Cover Photo">
    </div>

    <!-- Profile Picture -->
    <div class="profile-picture">
        {% if user.profile_picture %}
            <img src="{{ url_for('static', filename='profile_pics/' + user.profile_picture) }}" 
                alt="Profile Picture"
                style="width: 150px; height: 150px; object-fit: cover; border-radius: 50%; border: 4px solid white;" />
        {% else %}
            <img src="{{ url_for('static', filename='profile_pics/default.png') }}" 
                alt="Default Profile Picture" 
                style="width: 150px; height: 150px; object-fit: cover; border-radius: 50%; border: 4px solid white;" />
        {% endif %}
    </div>

    <!-- Profile Info -->
    <div class="profile-info">
        <h2 class="profile-username">{{ user.username }}</h2>
        {% if user.bio %}
            <p>{{ user.bio }}</p>
        {% endif %}
        <a href="{{ url_for('profile.edit_profile') }}">Edit Profile</a>
    </div>
    

    <!-- Navigation Tabs (optional links for future features) -->
    <div class="profile-nav">
        <a href="#">Posts</a>
        <a href="#">About</a>
        <a href="{{ url_for('friends.friends') }}">Friends</a>
        <a href="#">Photos</a>
    </div>

    <!-- Placeholder content -->
    <div class="profile-content">
        <p>This is where your content will go!</p>
    </div>

    {% if current_user != user %}
    {% set friendship = user.sent_requests | selectattr('friend_id', 'equalto', current_user.id) | first %}
    {% if friendship %}
        {% if friendship.status == 'pending' %}
            <form action="{{ url_for('friends.accept_friend_request', friendship_id=friendship.id) }}" method="POST">
                <button type="submit">Accept Friend Request</button>
            </form>
            <form action="{{ url_for('friends.reject_friend_request', friendship_id=friendship.id) }}" method="POST">
                <button type="submit">Reject Friend Request</button>
            </form>
        {% elif friendship.status == 'accepted' %}
            <button disabled>Already Friends</button>
        {% endif %}
    {% else %}
        <form action="{{ url_for('friends.send_friend_request', friend_id=user.id) }}" method="POST">
            <button type="submit">Send Friend Request</button>
        </form>
    {% endif %}
{% endif %}


</div>
{% endblock %}


